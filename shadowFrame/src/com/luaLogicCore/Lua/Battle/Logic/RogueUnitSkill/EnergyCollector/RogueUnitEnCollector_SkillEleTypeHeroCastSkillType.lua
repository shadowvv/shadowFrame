---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiangxuechen
--- DateTime: 2023/07/29 17:11
--- Describe:
---

---@class RogueUnitEnCollector_SkillEleTypeHeroCastSkillType : RogueUnitSkillEnergyCollectorBase
RogueUnitEnCollector_SkillEleTypeHeroCastSkillType = class(RogueUnitSkillEnergyCollectorBase, "RogueUnitEnCollector_SkillEleTypeHeroCastSkillType")


---@public
---@param _rogueUnitSkill RogueUnitSkillData
---@param _enCollectorXls RogueUnitSkillEnCollector
function RogueUnitEnCollector_SkillEleTypeHeroCastSkillType:Init(_rogueUnitSkill, _enCollectorXls)
	self:__Init(_rogueUnitSkill, _enCollectorXls)
	
	self.__checkNetId = _rogueUnitSkill:GetUnit():GetNetId()
	self.__checkEleId = _rogueUnitSkill:GetXlsData().elementType
	self.__checkSkillType = math.floor(_enCollectorXls.params[1])
	self:GetBattleRoom().rogueUnitSkillService:AddListener(BATTLE_LOGIC_EVENT_ENUM.USE_SKILL_START, self)
end

---@public
function RogueUnitEnCollector_SkillEleTypeHeroCastSkillType:OnRemove()
	self:__OnRemove()
	self:GetBattleRoom().rogueUnitSkillService:RemoveListener(BATTLE_LOGIC_EVENT_ENUM.USE_SKILL_START, self)
end

---@public
---@param _battleLogicEventV2 BattleLogicEventV2
function RogueUnitEnCollector_SkillEleTypeHeroCastSkillType:OnTrigEvent(_battleLogicEventV2)
	self:__OnTrigEvent(_battleLogicEventV2)

	local _netId = _battleLogicEventV2.netId
	if _netId ~= self.__checkNetId then
		return
	end

	local _obj = self:GetBattleRoom().battleObjectManager:GetObject(_battleLogicEventV2.objectId)
	---@type BattleObjCom_Config
	local _configCom = _obj:GetComponent(BattleObjectComponentType.Config)
	if _configCom:GetElementId() ~= self.__checkEleId then
		return
	end

	local _skillId = _battleLogicEventV2.eventCompareParam.skillId
	---@type Skill
	local skillConfig = self:GetBattleRoom().inputDataSource:GetDict("Skill", _skillId)
	if not skillConfig then
		return
	end

	if self.__checkSkillType ~= skillConfig.skillType then
		return
	end
	
	if CheckLogLevel(LogLevel.log) and LogTools.RogueUnitSkillLog then
		LogTools.LogByLevel(LogLevel.logErr, "肉鸽主公技", "同属性英雄施放技能增加主公技能量", "英雄", _obj:GetDataInstanceXls().name, "属性类型", self.__checkEleId, "技能类型", skillConfig.skillType, "添加属性", self.__addPropId, self.__addPropStr, "添加数量", self.__addPropNum)
	end
	self.__unitPropCom:IncreasePropByName(self.__addPropStr, self.__addPropNum)
end

return RogueUnitEnCollector_SkillEleTypeHeroCastSkillType