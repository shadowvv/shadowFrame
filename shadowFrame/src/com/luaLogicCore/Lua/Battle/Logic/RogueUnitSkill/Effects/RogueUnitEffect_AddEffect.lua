---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiangxuechen
--- DateTime: 2023/07/28 15:02
--- Describe:
---

---@class RogueUnitEffect_AddEffect : RogueUnitSkillEffectBase
RogueUnitEffect_AddEffect = class(RogueUnitSkillEffectBase, "RogueUnitEffect_AddEffect")

---@public
---@param _action RogueUnitSkillActionBase
---@param _xls RogueUnitSkillEffect
function RogueUnitEffect_AddEffect:Init(_action, _xls)
	self:__Init(_action, _xls)
	
	local _list = {}
	local _params = _xls.params
	for i = 2, #_params do
		table.insert(_list, math.floor(_params[i]))
	end
	---@private
	---@type number[]
	self.__addEffectList = _list
end

---@public
---@param _targetObjList BattleObjectBase[]
function RogueUnitEffect_AddEffect:OnTrig(_targetObjList)
	self:__OnTrig(_targetObjList)

	local _params = self:GetXlsData().params
	local _actionId = math.floor(_params[1])
	if CheckLogLevel(LogLevel.log) and LogTools.RogueUnitSkillLog then
		LogTools.LogByLevel(LogLevel.log, "肉鸽主公技", "    RogueUnitEffect_AddEffect:OnTrig", "Effect触发", "所属ActionId", self:GetAction():GetId(), "当前Effect ID", self:GetId(), "当前Effect类型", self:GetEffectTypeDesc(), "目标ActionId", _actionId, "要添加的EffectId列表", dumpTableEx(self.__addEffectList))
	end

	---@type BattleUnitCom_RogueUnitSkill
	local _rogueUnitSkillCom = self:GetUnit():GetComponent(BattleUnitComponentType.RogueUnitSkill)
	if not _rogueUnitSkillCom then return end
	local _rogueSkill = _rogueUnitSkillCom:GetRogueUnitSkill()
	if not _rogueSkill then return end
	local _actionData = _rogueSkill:GetAction(_actionId)
	if not _actionData then return end

	for i = 1, #self.__addEffectList do
		_actionData:AddEffectById(self.__addEffectList[i])
	end
end

return RogueUnitEffect_AddEffect