---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zhaopuyang.
--- DateTime: 2022/6/9 17:37

require "Lib/class"
require "Battle/Logic/Room/BattleLogicEvent/BattleLogicEventV2"

---@class BattleLogicPressKeyEvent : BattleLogicEventV2
---@field eventType number 事件类型
---@field battleId number 战斗id
---@field eventCompareParam table 事件参数
---@field eventTriggerParam table 事件透传参数
---@field netId number 事件产出单位Id
---@field objectId number 事件产出物体Id
BattleLogicPressKeyEvent = class(BattleLogicEventV2, 'BattleLogicPressKeyEvent');

---@param _eventType number 事件类型
---@param _battleId number 战斗id
---@param _eventCompareParam table 事件参数
---@param _eventTriggerParam table 事件透传参数
---@param _netId number 事件产出单位Id
---@param _objectId number 事件产出物体Id
function BattleLogicPressKeyEvent:ctor(_eventType, _eventCompareParam, _eventTriggerParam, _netId, _objectId, _battleId)
    self.battleId = _battleId
    self.eventType = _eventType;
    self.eventCompareParam = _eventCompareParam;
    self.eventTriggerParam = _eventTriggerParam;
    self.netId = _netId;
    self.objectId = _objectId;
    self.survival = 0;
end

---检测事件触发，默认没有比较参数
---@public
---@param _eventCompareParam table 比较参数
function BattleLogicPressKeyEvent:CheckEventTrigger(_eventCompareParam)
    ---compareParam.key 按键枚举
    ---compareParam.pressType 按下状态（按下为true）
    if self.eventCompareParam.key ~= _eventCompareParam.key then
        return false;
    end
    if self.eventCompareParam.pressType ~= _eventCompareParam.pressType then
        return false;
    end
    return true;
end

---事件回调，默认为空
---@public
function BattleLogicPressKeyEvent:FireEvent()
    if self.survival == 0 then

    end
end

---@public
---检测互斥事件
---@param _event BattleLogicEventV2 新事件
---@return boolean 是否互斥
function BattleLogicPressKeyEvent:CheckMutexEvent(_event)

    if _event.eventType == BATTLE_LOGIC_EVENT_ENUM.CHANGE_LEADER and self.netId == _event.netId then
        return true;
    end

    if self.eventType ~= _event.eventType then
        return false;
    end
    if self.netId ~= _event.netId then
        return false;
    end
    if self.eventCompareParam.key ~= _event.eventCompareParam.key then
        return false;
    end
    return true;
end

---检测移除事件，按下会在收到抬起时移除，抬起在下一帧移除
---@public
function BattleLogicPressKeyEvent:CheckRemoveEvent()
    return false;
end

---生成比较参数
---@public
function BattleLogicPressKeyEvent:GenerateCompareParam(_param);
    ---compareParam.key 按键枚举
    ---compareParam.pressType 按下状态（按下为true）
    local compareParam = {};
    local params = LuaTool:Split(_param,"_");
    local _key = tonumber(params[1]);
    local _pressType = params[2];
    if _pressType == "true" then
        _pressType = true;
    else
        _pressType = false;
    end
    compareParam.key = _key;
    compareParam.pressType = _pressType;
    return compareParam;
end

return BattleLogicPressKeyEvent;