---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zhaopuyang.
--- DateTime: 2023/3/31 12:06

require "Lib/class"

---@class NormalSkillActionState : table
---@field battleRoom BattleRoom 战斗
---@field stateParam StateParameter 状态参数配置
---@field unitType number 单位类型
---@field skillModel SkillModel 技能树
---@field currentNodes SkillBaseNode[] 当前帧节点
---@field nodeStartRunTimes number[] 节点执行时间
---@field nodeRunOvers number[] 节点执行结束
---@field loopInfos number[] 循环信息
NormalSkillActionState = class(SkillActionState, 'NormalSkillActionState');

---@param _battleId number 战斗id
---@param _stateParamId number 状态参数配置id
---@param _unitType number 单位类型
---@param _skillId number 技能Id
---@param _objectId number 释放的角色id
function NormalSkillActionState:ctor(_battleId, _stateParamId, _unitType, _skillId, _objectId)
    self.battleRoom = GetBattleRoom(_battleId)
    self.stateParam = self.battleRoom.inputDataSource:GetDict("StateParameter", _stateParamId);
    self.unitType = _unitType;
    self.skillModel = self.battleRoom.inputDataSource:GetSkillModel(_skillId);
    self.currentNodes = {};
    self.nodeStartRunTimes = {};
    self.nodeRunOvers = {};
    self.loopInfos = {};
    self.objectId = _objectId;
    self.isBreak = false;
    self.isSkillCastNodeOver = false;
    self.checkCollider = true;

    if LogTools.SkillLog and CheckLogLevel(LogLevel.log) and not self.skillModel then
        LogTools.LogByLevel(LogLevel.log,"技能没有配置",_skillId);
    end

    self.skillType = 1;
    ---@type Skill
    local skillConfig = self.battleRoom.inputDataSource:GetDict("Skill",self.skillModel.skillId);
    if skillConfig then
        self.skillType = skillConfig.skillType;
    end
    self.switchRule = self.battleRoom.inputDataSource:GetDict("StateSwitchRule",self:GetId());
end

-- 行为状态Id
---@return number 行为状态Id 参照stateSwitchRule表
function NormalSkillActionState:GetId()
    return 7;
end

return NormalSkillActionState;