---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zhaopuyang.
--- DateTime: 2023/7/7 18:44

require "Lib/class"

---@class TalentSkillCheckCurrentObjectTrigger : table
TalentSkillCheckCurrentObjectTrigger = class(nil, 'TalentSkillCheckCurrentObjectTrigger');

function TalentSkillCheckCurrentObjectTrigger:ctor(_battleId)

    ---@type number
    self.battleId = _battleId
    self.lastTriggerTime = TimeUtils.battleNow(self.battleId);
    self.battleRoom = GetBattleRoom(self.battleId)

end

---@public
---@param _battleObject BattleObjectBase 触发单位
---@param _talentSkillTrigger SkillTrigger 被动技能配置
---@param _talentSkill BattlePlayerTalentSkill 被动技能
function TalentSkillCheckCurrentObjectTrigger:Check(_battleObject, _talentSkillTrigger,_talentSkill)
    if _talentSkillTrigger.parm1 and _talentSkillTrigger.parm1 ~= 0 then
        if _talentSkillTrigger.parm2 and _talentSkillTrigger.parm2 ~= 0 then
            local num = 0;
            for i, v in pairs(_battleObject:GetParentUnit():GetAllObjectDic()) do
                if v then
                    ---@type Leader
                    local leader = v:GetInstanceXls();
                    if leader and leader.property == _talentSkillTrigger.parm1 then
                        num = num + 1;
                    end
                end
            end
            return num;
        else
            local currentObject  = _battleObject:GetParentUnit():GetCurrentHeroObject();
            if currentObject then
                ---@type Leader
                local leader = currentObject:GetInstanceXls();
                if leader and leader.property == _talentSkillTrigger.parm1 then
                    return 1;
                end
            end
        end
    end
    return 0;
end

---被动技能触发类型
---@return number 被动技能触发类型
function TalentSkillCheckCurrentObjectTrigger:GetType()
    return 136;
end

return TalentSkillCheckCurrentObjectTrigger;