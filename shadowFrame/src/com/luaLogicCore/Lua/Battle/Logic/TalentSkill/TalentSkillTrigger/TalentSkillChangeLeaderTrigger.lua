---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zhaopuyang.
--- DateTime: 2022/11/1 17:02

require "Lib/class"

---@class TalentSkillChangeLeaderTrigger : table
TalentSkillChangeLeaderTrigger = class(nil, 'TalentSkillChangeLeaderTrigger');

function TalentSkillChangeLeaderTrigger:ctor(_battleId)
    ---@type number
    self.battleId = _battleId
    self.battleRoom = GetBattleRoom(self.battleId)
    self.lastTriggerTime = TimeUtils.battleNow(self.battleId);
end

---@public
---@param _battleObject BattleObjectBase 触发单位
---@param _talentSkillTrigger SkillTrigger 被动技能配置
---@param _talentSkill BattlePlayerTalentSkill 被动技能
function TalentSkillChangeLeaderTrigger:Check(_battleObject, _talentSkillTrigger,_talentSkill)

    if TimeUtils.battleNow(self.battleId) - self.lastTriggerTime < _talentSkillTrigger.parm6 then
        return 0;
    end

    if self.battleRoom.battleLogicEventService:CheckChangeLeaderEvent(_battleObject:GetParentUnit():GetNetId()) then
        if _talentSkillTrigger.parm1 and _talentSkillTrigger.parm1 == 1 then
            if _battleObject:GetParentUnit():GetCurrentHeroObjectId() == _battleObject:GetObjectId() then
                return 0;
            end
        else
            if _battleObject:GetParentUnit():GetCurrentHeroObjectId() ~= _battleObject:GetObjectId() then
                return 0;
            end
        end

        if _talentSkillTrigger.parm3 and _talentSkillTrigger.parm3 ~= 0 then
            ---@type Leader
            local leader = _battleObject:GetInstanceXls();
            if leader.property ~= _talentSkillTrigger.parm3 then
                return 0;
            end
        end
        return 1;
    end
    return 0;
end

---@public
function TalentSkillChangeLeaderTrigger:Reset()

end

---被动技能触发类型
---@return number 被动技能触发类型
function TalentSkillChangeLeaderTrigger:GetType()
    return 118;
end


return TalentSkillChangeLeaderTrigger;