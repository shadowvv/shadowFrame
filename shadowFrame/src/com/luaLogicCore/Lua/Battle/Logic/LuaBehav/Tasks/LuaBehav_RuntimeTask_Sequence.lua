---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiangxuechen
--- DateTime: 2021/12/28 11:07
--- Describe: 行为树顺序节点
---

---@class LuaBehav_RuntimeTask_Sequence : LuaBehav_RuntimeTask
LuaBehav_RuntimeTask_Sequence = class(LuaBehav_RuntimeTask, "LuaBehav_RuntimeTask_Sequence")


function LuaBehav_RuntimeTask_Sequence:IsInterruptTask()
	return true
end

function LuaBehav_RuntimeTask_Sequence:OnStart()
	self:__OnStart()
end

function LuaBehav_RuntimeTask_Sequence:OnExit()
	self:__OnExit()
end

function LuaBehav_RuntimeTask_Sequence:OnAbort()
	self:__OnAbort()
end

function LuaBehav_RuntimeTask_Sequence:CheckCanExecute()
	local _stateList = self.childStateList
	
	if self.curExcuteChildCnt == #_stateList then return false end
	
	local _checkState_1 = LuaBehav_Define_TaskState.Abort
	local _checkState_2 = LuaBehav_Define_TaskState.Failure
	local _hideList = self.childHideList
	for i = 1, #_stateList do
		if not _hideList[i] then
			local _childState = _stateList[i]
			if _checkState_1 == _childState or _checkState_2 == _childState then
				return false
			end
		end
	end
	
	return true
end

function LuaBehav_RuntimeTask_Sequence:ReCountTaskState(_taskState)
	local _state = LuaBehav_Define_TaskState.Success
	local _stateList = self.childStateList
	local _hideList = self.childHideList
	for i = 1, #_stateList do
		if not _hideList[i] then
			local _childState = _stateList[i]
			if LuaBehav_Define_TaskState.Abort == _childState then
				_state = LuaBehav_Define_TaskState.Abort
				break
			end

			if LuaBehav_Define_TaskState.Running == _childState then
				_state = LuaBehav_Define_TaskState.Running
				break
			end
			if LuaBehav_Define_TaskState.Success ~= _childState then
				_state = LuaBehav_Define_TaskState.Failure
				break
			end
		end
	end
	self:__SetTaskState(_state)
	return _state
end

return LuaBehav_RuntimeTask_Sequence