---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiangxuechen
--- DateTime: 2021/12/29 16:03
--- Describe: 循环节点
---

---@class LuaBehav_RuntimeTask_Repeat : table
LuaBehav_RuntimeTask_Repeat = class(LuaBehav_RuntimeTask, "LuaBehav_RuntimeTask_Repeat")


function LuaBehav_RuntimeTask_Repeat:OnStart()
	self:__OnStart()
	
	--重复的最大次数，如果小于1(或者没赋值)，表示一直重复
	--注意：这里的1表示重复1次，也就是一共运行了2次
	local _maxTimes = self.configTask.times 
	if not _maxTimes or _maxTimes < 1 then
		self.repeatForever = true
	else
		self.repeatForever = false
		self.timesTotal = _maxTimes
	end
	self.timesAcc = 0
end


function LuaBehav_RuntimeTask_Repeat:OnChildStart()
	self:__OnChildStart()
	if self.curExcuteChildCnt <= #self.childIndexList then return end
	
	if self.repeatForever or self.timesAcc < self.timesTotal then
		self:__OnExit()
		self.timesAcc = self.timesAcc + 1
		self.curExcuteChildCnt = 1
	end
end

return LuaBehav_RuntimeTask_Repeat