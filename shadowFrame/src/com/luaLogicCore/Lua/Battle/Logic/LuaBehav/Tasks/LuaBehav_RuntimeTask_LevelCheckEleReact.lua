---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiangxuechen
--- DateTime: 2022/06/16 16:10
--- Describe: 关卡检查发生元素反应
--- 

---@class LuaBehav_RuntimeTask_LevelCheckEleReact : LuaBehav_RuntimeTask
LuaBehav_RuntimeTask_LevelCheckEleReact = class(LuaBehav_RuntimeTask, "LuaBehav_RuntimeTask_LevelCheckEleReact")

function LuaBehav_RuntimeTask_LevelCheckEleReact:IsConditionalTask()
	return true
end

-- 
function LuaBehav_RuntimeTask_LevelCheckEleReact:__RegistListener()
	self.__checkReactId = self.configTask.checkReactId
	self.__checkCampList = self.configTask.checkCampList
	self:RegistListenEvent(LuaBehav_Define_TaskListenEnum.EleReact)
	self.__registed = true
end

function LuaBehav_RuntimeTask_LevelCheckEleReact:OnListenEvent(_param)
	if self.__listen then return end
	if self.__checkReactId ~= _param.reactId then return end
	local _reactCamp = _param.reactCamp
	for _, _camp in pairs(self.__checkCampList) do
		if _camp == _reactCamp then
			self.__listen = true
			break
		end
	end
end

function LuaBehav_RuntimeTask_LevelCheckEleReact:OnUpdate()
	if not self.__registed then
		self:__RegistListener()
	end
	
	local _retState = LuaBehav_Define_TaskState.Failure
	if self.__listen then
		_retState = LuaBehav_Define_TaskState.Success
	end

	self:__SetTaskState(_retState)
	return _retState
end

function LuaBehav_RuntimeTask_LevelCheckEleReact:Clear()
	self:RemoveListenEvent(LuaBehav_Define_TaskListenEnum.EleReact)
	self:__Clear()
	self.__registed = nil
	self.__checkReactId = nil
	self.__checkCampList = nil
end

return LuaBehav_RuntimeTask_LevelCheckEleReact