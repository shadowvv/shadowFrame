---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiangxuechen
--- DateTime: 2022/01/20 16:58
--- Describe: 事件监听节点
---

---@class LuaBehav_RuntimeTask_Event : LuaBehav_RuntimeTask
LuaBehav_RuntimeTask_Event = class(LuaBehav_RuntimeTask, "LuaBehav_RuntimeTask_Event")

function LuaBehav_RuntimeTask_Event:IsConditionalTask()
	return true
end

---@param _runtimeBehavTree LuaBehav_RuntimeBehavTree
function LuaBehav_RuntimeTask_Event:Init(_battleId, _runtimeBehavTree, _taskIndex, _parentTaskIndex, _configTask, _cntInParent)
	self:__Init(_battleId, _runtimeBehavTree, _taskIndex, _parentTaskIndex, _configTask, _cntInParent)
	self.useState = LuaBehav_Define_TaskState.Failure
	self.__eventType = _configTask.eventType
	_runtimeBehavTree.runtimeBehavMgr:AddEventDic(self.__eventType, self)
end

function LuaBehav_RuntimeTask_Event:OnUpdate(_deltaTime)
	self:__SetTaskState(self.useState)
	return self.useState
end

-- 
function LuaBehav_RuntimeTask_Event:OnEvent(_paramTab)
	if self.paused then return end
	local _eventType = self.__eventType
	if _eventType == LuaBehav_Define_EventTaskType.SpecificMonsOnHurt then
		self:OnCaseSpecificMonsOnHurt(_paramTab)
	end
end

-- 
function LuaBehav_RuntimeTask_Event:OnCaseSpecificMonsOnHurt(_paramTab)
	local _netId = _paramTab.netId
	if _netId == self.netId then
		self.useState = LuaBehav_Define_TaskState.Success
		self.behavTree.runtimeBehavMgr:RemoveEventDic(self.__eventType, self)
	end
end

-- 清理
function LuaBehav_RuntimeTask_Event:Clear()
	
	self.behavTree.runtimeBehavMgr:RemoveEventDic(self.__eventType, self)
	self.__eventType = nil
	self:__Clear()
end

return LuaBehav_RuntimeTask_Event