---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiangxuechen
--- DateTime: 2023/07/12 15:00
--- Describe:
---

---@class LuaBehav_RuntimeTask_LevelCheckEleBreak : LuaBehav_RuntimeTask
LuaBehav_RuntimeTask_LevelCheckEleBreak = class(LuaBehav_RuntimeTask, "LuaBehav_RuntimeTask_LevelCheckEleBreak")
function LuaBehav_RuntimeTask_LevelCheckEleBreak:IsConditionalTask()
	return true
end

-- 
function LuaBehav_RuntimeTask_LevelCheckEleBreak:__RegistListener()
	self.__checkElementId = self.configTask.elementType
	self.__checkLevelUnitId = self.configTask.levelUnitId
	self.__ret = LuaBehav_Define_TaskState.Failure
	self:RegistListenEvent(LuaBehav_Define_TaskListenEnum.EleBreak)
	self.__registed = true
end

function LuaBehav_RuntimeTask_LevelCheckEleBreak:OnListenEvent(_param)
	--LogTools.LogByLevel(LogLevel.logErr, "LuaBehav_RuntimeTask_LevelCheckEleBreak:OnListenEvent", "_param", dumpTableEx(_param), "self.__checkLevelUnitId", self.__checkLevelUnitId, "self.__checkElementId", self.__checkElementId)
	if self.__listen then return end
	if self.__checkLevelUnitId ~= _param.levelUnitId then return end
	if self.__checkElementId ~= _param.elementId and self.__checkElementId ~= LuaBehav_Define_CheckElementType.Any then
		--LogTools.LogByLevel(LogLevel.logErr, "LuaBehav_RuntimeTask_LevelCheckEleBreak:OnListenEvent end 1", "self.__ret", LogTools.GetEnumTableDesc(LuaBehav_Define_TaskState, self.__ret))
		return
	end 

	if _param.isEnter then
		self.__ret = LuaBehav_Define_TaskState.Success
	else
		self.__ret = LuaBehav_Define_TaskState.Failure
	end
	--LogTools.LogByLevel(LogLevel.logErr, "LuaBehav_RuntimeTask_LevelCheckEleBreak:OnListenEvent end 2", "self.__ret", LogTools.GetEnumTableDesc(LuaBehav_Define_TaskState, self.__ret))
end

function LuaBehav_RuntimeTask_LevelCheckEleBreak:OnUpdate()
	if not self.__registed then
		self:__RegistListener()
	end
	
	self:__SetTaskState(self.__ret)
	return self.__ret
end

function LuaBehav_RuntimeTask_LevelCheckEleBreak:Clear()
	self:RemoveListenEvent(LuaBehav_Define_TaskListenEnum.EleBreak)
	self:__Clear()
	self.__registed = nil
	self.__checkElementId = nil
	self.__checkLevelUnitId = nil
	self.__ret = nil
end
return LuaBehav_RuntimeTask_LevelCheckEleBreak