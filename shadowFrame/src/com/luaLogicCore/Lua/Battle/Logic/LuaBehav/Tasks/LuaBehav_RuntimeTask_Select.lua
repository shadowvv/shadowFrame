---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jiangxuechen
--- DateTime: 2021/12/28 15:43
--- Describe: 选择节点
---

---@class LuaBehav_RuntimeTask_Select : table
LuaBehav_RuntimeTask_Select = class(LuaBehav_RuntimeTask, "LuaBehav_RuntimeTask_Select")


function LuaBehav_RuntimeTask_Select:IsInterruptTask()
	return true
end

function LuaBehav_RuntimeTask_Select:CheckCanExecute()
	local _stateList = self.childStateList
	
	if self.curExcuteChildCnt == #_stateList then return false end
	
	local _checkState_1 = LuaBehav_Define_TaskState.Abort
	local _checkState_2 = LuaBehav_Define_TaskState.Success
	local _checkState_3 = LuaBehav_Define_TaskState.Running
	
	for i = 1, #_stateList do
		local _childState = _stateList[i]
		if _checkState_1 == _childState or _checkState_2 == _childState or _checkState_3 == _childState then
			return false
		end
	end
	
	return true
end

function LuaBehav_RuntimeTask_Select:ReCountTaskState(_taskState)
	local _state = LuaBehav_Define_TaskState.Failure
	local _stateList = self.childStateList
	for i = 1, #_stateList do
		local _childState = _stateList[i]
		LuaBehav_DebugTool.PrintTask("LuaBehav_RuntimeTask_Select", "ReCountTaskState", "i", i, "state", LuaBehav_DebugTool.GetTaskStateDesc(_childState))
		if LuaBehav_Define_TaskState.Abort == _childState then
			_state = LuaBehav_Define_TaskState.Abort
			break
		end
		
		if LuaBehav_Define_TaskState.Success == _childState then
			_state = LuaBehav_Define_TaskState.Success
			break
		end
		
		if LuaBehav_Define_TaskState.Running == _childState then
			_state = LuaBehav_Define_TaskState.Running
			break
		end
	end
	LuaBehav_DebugTool.PrintTask("LuaBehav_RuntimeTask_Select", "ReCountTaskState", "final state", LuaBehav_DebugTool.GetTaskStateDesc(_state))
	self:__SetTaskState(_state)
	return _state
end

return LuaBehav_RuntimeTask_Select